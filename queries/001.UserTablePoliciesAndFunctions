CREATE POLICY
  "Can only view own profile data."
  ON public."User"
  FOR SELECT
  USING ( auth.uid() = "Id" );

CREATE POLICY
  "Can only update own profile data."
  ON public."User"
  FOR UPDATE
  USING ( auth.uid() = "Id" );

CREATE FUNCTION
  public.create_profile_for_new_user()
  RETURNS TRIGGER AS
  $$
  BEGIN
    INSERT INTO public."User" ("Id")
    VALUES (NEW.id);
    RETURN NEW;
  END;
  $$ LANGUAGE plpgsql SECURITY DEFINER;

CREATE TRIGGER
  create_profile_on_signup
  AFTER INSERT ON auth.users
  FOR EACH ROW
  EXECUTE PROCEDURE
    public.create_profile_for_new_user();